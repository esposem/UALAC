<link rel="import" href="/bower_components/polymer/polymer.html">

<!-- build:remove -->
<link rel="import" href="/styles/shared-styles.html">
<!-- /build -->

<dom-module id="ab-thumblist">
  <template>

    <!-- build:remove -->
    <style include="shared-styles"></style>
    <style>
      :host {
        display: block;
      }

      .text-muted, .text-muted a, a.text-muted {
        color: rgb(162,162,162);
      }

      ul.grid-list{
        list-style:none;
        margin: 5px; 
        padding:0;
      }

      ul.grid-list > li{
        width: 25%;
        float: left;
        margin: 10px 0;
        padding: 0 10px!important;
      }

      .media-object{
        height: 100%;
        position:relative;
      }

      .mo-image{
        height: inherit;
        background-position: center;
        background-size: cover;
        height: 100%;
        padding-bottom: 100%;
        position: relative;
        width: 100%;
      }

      .mo-overlay{
        position:absolute;
        top:0;
        left:0;
        height:100%;
        width: 100%;
        box-shadow: inset 0 0 0 200px rgba(0,0,0,0.4);
        -webkit-transition: all 0.4s ease-in-out;
        -moz-transition: all 0.4s ease-in-out;
        -ms-transition: all 0.4s ease-in-out;
        -o-transition: all 0.4s ease-in-out;
        transition: all 0.4s ease-in-out;
      }

      .mo-overlay:hover{
        box-shadow: inset 0 0 0 0 rgba(0,0,0,0.1);
      }

      .mo-info{
        height: 63px;
        background:rgb(224, 224, 224);
        padding: 5px 8px;
      }

      .mo-info.subtitle{
        height: 90px;
      }

      .mo-title {
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        border-bottom: 0;
        line-height: 19px;
        max-height: 38px;
      }

      .mo-subtitle, .mo-title {
        display: block;
        margin: 0 0 8px;
        max-width: 100%;
      }

      .mo-subtitle{
        display: block;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      @media (max-width: 640px) {
        ul.grid-list > li{
          width: 49%;
          margin: 5px 0;
          padding: 0 5px!important;
        }
      }
    </style>

    <ul class="grid-list clearfix">
      <template is="dom-repeat" items="[[data]]">
        <li>
          <div class="media-object">
            <div class="mo-image" style$="{{_calcMoImageStyle(item.artwork)}}"></div>
            <div class="mo-overlay"></div>
          </div>
          <div class="mo-info subtitle">
            <!-- this means it's an album -->
            <template is="dom-if" if="{{item.artist}}">
              <a class="mo-title" href$="{{_calcAlbumHref(item._id)}}">{{item.name}}</a>
              <div class="mo-subtitle text-muted one-line">
               <a title="{{item.name}}" href$="{{_calcArtistHref(item.artist._id)}}">{{item.artist.name}}</a>
             </div>
           </template>
            <!-- this means it's an artist -->
            <template is="dom-if" if="{{! item.artist}}">
              <a class="mo-title" href$="{{_calcArtistHref(item._id)}}">{{item.name}}</a>
           </template>
         </div>
        </li>
      </template>  
    </ul>

  <!-- /build -->
  </template>
  
  <script>
    (function () {
      'use strict';

      Polymer({
        is: 'ab-thumblist',

        //<!-- build:remove -->
        properties: {
          data:{
            type: Array,
            notify: true,
          }
        },

        _calcMoImageStyle: function(artwork){
          return `background-image: url("/${artwork}")`;
        },
        _calcAlbumHref: function(name){
          return `/albums/${name}`;
        },
        _calcArtistHref: function(name){
          return `/artists/${name}`;
        }
        //<!-- /build -->
      });

    })();
  </script>

</dom-module>
